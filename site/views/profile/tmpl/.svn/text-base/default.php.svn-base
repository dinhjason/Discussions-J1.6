<?php
/*
 * views/posting/tmpl/default.php
 *
 * Autor: Achim Fischer
 *
 */



// no direct access
defined('_JEXEC') or die('Restricted access');

JHTML::_('stylesheet', 'discussions.css', 'components/com_discussions/assets/');


$user =& JFactory::getUser();
$cUser = new CUser( $user->id);

// get parameters
$params = JComponentHelper::getParams('com_discussions');
?>





<?php 
if ( $this->params->def( 'show_page_title', 1 ) ) : 
	?>
	<div class="componentheading<?php echo $this->escape($this->params->get('pageclass_sfx')); ?>">
		<?php echo $this->escape($this->params->get('page_title')); ?>
	</div>
	<?php 
endif; 
?>



<!-- HTML Box Top -->
<?php
$htmlBoxProfileTop = $params->get('htmlBoxProfileTop', '');

if ( $htmlBoxProfileTop != "") {
	echo "<div class='cofiHtmlBoxProfileTop'>";
		echo $htmlBoxProfileTop;
	echo "</div>";
}
?>
<!-- HTML Box Top -->



<?php
include( 'components/com_discussions/includes/topmenu.php');
?>





<?php
echo "<h3>";
	echo $this->headline;
echo "</h3>";
?>



<!-- Breadcrumb -->
<table style="margin-top: 5px;">
    <tr>
        <td>
            <?php
            $menuLinkHome     = JRoute::_( 'index.php?option=com_discussions');
            $menuText = JSite::getMenu()->getActive()->name;
            echo "<a href='$menuLinkHome'>" . $menuText . "</a>";
            ?>
        </td>
        <td>
            <?php
            	echo "&nbsp;&raquo;&nbsp;";
            	echo JText::_( "Profile", true );
            ?>
        </td>
    </tr>
</table>
<!-- Breadcrumb -->




<?php

echo "<br />";


echo "<div class='cofiProfileContent'>";


echo "<form action='' method='post' name='postform' id='postform' enctype='multipart/form-data'>";

	echo "<table cellspacing='0' cellpadding='0' width='100%' border='0' >";

		echo "<tr>";
			echo "<td align='left' valign='top' width='100%' style='padding: 10px;' colspan='2'>";

				echo "<div class='cofiProfileUsername'>";
					echo $user->username;
			    echo "</div>";
						
				echo "<div class='cofiProfileName'>";
					echo "&nbsp;&nbsp;&nbsp;(".$user->name.")";
			    echo "</div>";

				echo "<br />";
			echo "</td>";    
		echo "</tr>";


		echo "<tr>";
		
			$useUserProfileExtension = false;
		
			// left column			
			echo "<td align='left' valign='top' width='50%' style='padding: 10px;' >";
			
				echo "<div class='cofiProfileLocationBox'>";

					echo "<div class='cofiProfileLocationHeader'>";
						echo "<div class='cofiProfileHeader'>";
								echo "Location";
								
								if ( $useUserProfileExtension) {
									echo "&nbsp;";
									echo "<a href='" . JRoute::_( '/my-account') . "' style='font-size: 0.8em; font-weight: normal;'>change</a>";
								}
								
					    echo "</div>";
				    echo "</div>";
	
					echo "<div class='cofiProfileLocationRow'>";
						echo "<div class='cofiProfileLocationLabel'>";
							echo "Zipcode: ";
				    	echo "</div>";
						echo "<div class='cofiProfileLocationValue'>";
						
							if ( $useUserProfileExtension) {
								echo $user->zipcode;
								echo "<br />";
							}
							else {
	            				echo "<input type='text' name='zipcode' id='zipcode' size='5' maxlength='10' value='".$cUser->getZipcode()."'>";					
							}
	            			
				    	echo "</div>";
				    echo "</div>";
	
	
					echo "<div class='cofiProfileLocationRow'>";
						echo "<div class='cofiProfileLocationLabel'>";
							echo "City: ";
					    echo "</div>";
						echo "<div class='cofiProfileLocationValue'>";
						
							if ( $useUserProfileExtension) {
								echo $user->city;
								echo "<br />";
							}
							else {
		            			echo "<input type='text' name='city' id='city' size='30' maxlength='100' value='".$cUser->getCity()."'>";
		            		}
		            		
					    echo "</div>";
				    echo "</div>";
	
					echo "<div class='cofiProfileLocationRow'>";
						echo "<div class='cofiProfileLocationLabel'>";
							echo "Country: ";
					    echo "</div>";
						echo "<div class='cofiProfileLocationValue'>";
						
							if ( $useUserProfileExtension) {
								echo $user->country;
								echo "<br />";
							}
							else {
								include( 'components/com_discussions/includes/countryselect.php');
							}
							
					    echo "</div>";
				    echo "</div>";

			    echo "</div>";


				echo "<div class='cofiProfileStatusBox'>";

					echo "<div class='cofiProfileStatusHeader'>";
						echo "<div class='cofiProfileHeader'>";
							echo "Forum Status";
			    		echo "</div>";
			    	echo "</div>";

					echo "<div class='cofiProfileStatusRow'>";
						echo "<div class='cofiProfileStatusLabel'>";
							echo "Posts: ";
					    echo "</div>";
						echo "<div class='cofiProfileStatusValue'>";
							echo $cUser->getPosts();
					    echo "</div>";
				    echo "</div>";

					echo "<div class='cofiProfileStatusRow'>";
						echo "<div class='cofiProfileStatusLabel'>";
							echo "Moderated: ";
					    echo "</div>";
						echo "<div class='cofiProfileStatusValue'>";
							if ( $cUser->isRookie() || $cUser->isModerated()) {
								echo "Yes";
							}
							else {
								echo "No";
							}
					    echo "</div>";
				    echo "</div>";
			    
			    echo "</div>";



			    							
			echo "</td>";    
			// left column
									 
									 
			// right column		
			echo "<td align='left' valign='top' width='50%' style='padding: 10px;' >";

				echo "<div class='cofiProfileAvatarBox'>";

					echo "<div class='cofiProfileAvatarHeader'>";
						echo "<div class='cofiProfileHeader'>";
							echo "Avatar";
			    		echo "</div>";
			    	echo "</div>";

					echo "<div class='cofiProfileAvatarRow'>";
					    echo "<div class='cofiAvatarBox'>";			    			    
					    	if ( $cUser->getAvatar() == "") { 
					        	echo "<img src='".$mosConfig_live_site."/components/com_discussions/assets/users/user.png' class='cofiAvatar' alt='$user->username' />";
					    	}
					    	else { 
					        	echo "<img src='".$mosConfig_live_site."/components/com_discussions/assets/users/".$user->id."/large/".$cUser->getAvatar()."' class='cofiAvatar' alt='$user->username' />";
					    	}			    
					    echo "</div>";
				    echo "</div>";

				
					echo "<div class='cofiProfileAvatarRow'>";				    			    
						echo "<div class='cofiTextHeader'>Avatar upload:</div> ";
		                	echo "<input class='cofiText' type='file' name='avatar'>";								
		        		echo "<div class='cofiTextFooter'>(max 200 KByte, JPG or PNG, optimal size 128x128)</div> ";
				    echo "</div>";


			    echo "</div>";
			 
			echo "</td>";    
			// right column
									 									    			
		echo "</tr>";



		echo "<tr>";
		
			echo "<td align='left' valign='top' style='padding: 5px;' colspan='2'>";
		
				echo "<div class='cofiProfileSignatureBox'>";

					echo "<div class='cofiProfileSignatureHeader'>";
						echo "<div class='cofiProfileHeader'>";
							echo "Signature";
			    		echo "</div>";
			    	echo "</div>";

					echo "<div class='cofiProfileSignatureRow'>";
					
						echo "<div class='cofiTextHeader'>Text:</div> ";
							echo "<div class='cofiText'>";			    			
								echo "<textarea name='signature' cols='70' rows='3' wrap='VIRTUAL' id='signature'>";
										echo $this->signature;
							echo "</textarea>";
						echo "</div>";
						
		        		echo "<div class='cofiTextFooter'>(max 250 characters, no HTML allowed)</div> ";
					
					
				    echo "</div>";
			    
			    echo "</div>";
		
			echo "</td>";    			    			
		echo "</tr>";
        		

		echo "<tr>";
			echo "<td align='left' valign='top' style='padding-left: 10px;' colspan='2'>";
        		
        		echo "<div class='cofiTextButton'>";
					echo "<input type='hidden' name='task' value='save'>";  			            		
					echo "<input class='cofiButton' type='submit' name='submit' value='Save'>";
				echo "</div> ";
								
			echo "</td>";    			    			
		echo "</tr>";


	echo "</table>";

echo "</form>";


echo "</div>";
?>



<!-- HTML Box Bottom -->
<?php
$htmlBoxProfileBottom = $params->get('htmlBoxProfileBottom', '');		

if ( $htmlBoxProfileBottom != "") {
	echo "<div class='cofiHtmlBoxProfileBottom'>";
		echo $htmlBoxProfileBottom;
	echo "</div>";
}
?>
<!-- HTML Box Bottom -->


<?php
include( 'components/com_discussions/includes/footer.php');

